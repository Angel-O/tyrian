<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.89.4" />
    <meta name="description" content="Elm inspired Scala Web Framework">
<meta name="author" content="Dave Smith">

    <link rel="icon" href="/tyrian/images/favicon.png" type="image/png">

    <title>Architecture &amp; Patterns - Tyrian</title>

    
    <link href="/tyrian/css/nucleus.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/fontawesome-all.min.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/hybrid.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/featherlight.min.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/perfect-scrollbar.min.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/auto-complete.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/atom-one-dark-reasonable.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/theme.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/tabs.css?1642039146" rel="stylesheet">
    <link href="/tyrian/css/hugo-theme.css?1642039146" rel="stylesheet">
    
    <link href="/tyrian/css/foo.css?1642039146" rel="stylesheet"><link href="/tyrian/css/bar.css?1642039146" rel="stylesheet">

    <script src="/tyrian/js/jquery-3.3.1.min.js?1642039146"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/tyrian/architecture/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <h1>Tyrian</h1>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/tyrian/js/lunr.min.js?1642039146"></script>
<script type="text/javascript" src="/tyrian/js/auto-complete.js?1642039146"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/purplekingdomgames.github.io\/tyrian";
    
</script>
<script type="text/javascript" src="/tyrian/js/search.js?1642039146"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/tyrian/installation/" title="Setup &amp; Configuration" class="dd-item
        
        
        
        ">
      <a href="/tyrian/installation/">
          Installation
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/tyrian/architecture/" title="Architecture &amp; Patterns" class="dd-item
        parent
        active
        
        ">
      <a href="/tyrian/architecture/">
          Architecture
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/tyrian/examples/" title="Examples" class="dd-item
        
        
        
        ">
      <a href="/tyrian/examples/">
          Examples
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/tyrian/information/" title="General Information" class="dd-item
        
        
        
        ">
      <a href="/tyrian/information/">
          Information
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/PurpleKingdomGames/tyrian"><i class='fab fa-github'></i> Github</a>
              </li>
          
              <li>
                  <a class="padding" href="https://purplekingdomgames.github.io/tyrian/api/"><i class='fas fa-bookmark'></i> Tyrian API Docs</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/tyrian/'>Tyrian</a> > Architecture & Patterns
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#the-elm-architecture">The Elm Architecture</a></li>
        <li><a href="#tyrian-vs-elm">Tyrian vs Elm</a></li>
        <li><a href="#tyrian-vs-indigo">Tyrian vs Indigo</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Architecture &amp; Patterns
            </h1>
          

        



	<h3 id="the-elm-architecture">The Elm Architecture</h3>
<p>Tyrian provides a runtime environment for executing applications designed
according to the <a href="https://guide.elm-lang.org/architecture/">Elm architecture</a>.</p>
<p>Elm is the name of a language and an ecosystem, but it&rsquo;s architecture has become more widely known as the &lsquo;TEA Pattern&rsquo; (<em>(T)he (E)lm (A)rchitecture</em>) and has influenced many GUI/UI libraries and implementations beyond the world of functional programming.</p>
<h4 id="the-tea-pattern">The TEA pattern</h4>
<p>The TEA Pattern is about:</p>
<ol>
<li>Immutable data.</li>
<li>Pure functions.</li>
<li>Uni-directional data flow.</li>
<li>Strictly ordered events and updates.</li>
</ol>
<p>This gives you a system that is very easy it reason about, since the data cannot/is unlikely to be subject to hard-to-test race conditions or side effects, and everything happens in a predictable order.</p>
<p>The purity of the system, the way that the state is held apart from the processing and rendering functions, also allows for easy testing without the need for complex mocking.</p>
<p>In essence, the state of the application is modeled by an immutable <code>Model</code>,
events that change the state of the application are modeled by an immutable
<code>Msg</code> type, state transitions are implemented by a <code>(Msg, Model) =&gt; Model</code>
function, and finally, a <code>Model =&gt; Html[Msg]</code> function defines how to render
the state of the application in HTML.</p>
<h3 id="tyrian-vs-elm">Tyrian vs Elm</h3>
<p>Elm is, as you would expect, a far richer offering that Tyrian is or in all likelihood, ever will be. There are a lot more people working on it and with it, and it&rsquo;s been around a lot longer.</p>
<p>Having said that, while Elm&rsquo;s architecture has taken on a life of it&rsquo;s own and influenced the state of the art of functional (and even non-FP!) UI programming, Elm itself is still quite niche.</p>
<p>People tend to love Elm, or hate it. A lot of that reaction can be attributed to the fact that Elm is a very opinionated language, and you&rsquo;re either into that ..or you&rsquo;re not.</p>
<p>What Elm&rsquo;s opinionated stance buys you is an ecosystem where if your code compiles, it works! And that is an amazing thing! In the cost/benefit analysis: The benefit is an incredibly robust web development experience, at the cost of literally not being able to do anything that is not permitted (because it would break the robustness guarantees of the ecosystem).</p>
<p>Tyrian takes the glorious essence of Elm&rsquo;s architecture, but removes almost all of the opinions &hellip;and with it of course, almost all of the safety nets!</p>
<ul>
<li>Want to break up your code into lots of files and classes? Carry on.</li>
<li>Want to use refined types? Ok then.</li>
<li>Want to use Typeclasses? No problem.</li>
<li>Want to bring in a heavyweight FP library? Sure thing.</li>
<li>Want to talk to JavaScript directly over an FFI? Go nuts.</li>
<li>Want to do a non-exhaustive match? I mean, you can but&hellip;</li>
<li>Want to throw a massive exception? &hellip;erm&hellip;</li>
</ul>
<p>Be safe out there folks! ðŸ˜€</p>
<h3 id="tyrian-vs-indigo">Tyrian vs Indigo</h3>
<p>Tyrian and Indigo are siblings and both follow an interpretation of the TEA Pattern, but they grew up at different times under different influences, and so are not the same.</p>
<p>Tyrian is designed in the same image as Elm, and for the same purpose: Building rich web apps. Indigo however is a game engine. They do have a lot of things in common:</p>
<ul>
<li>The APIs are all pure functions</li>
<li>The state is immutable</li>
<li>The data follows a uni-directional path</li>
<li>Events/Messages are strictly ordered</li>
<li>&hellip;even the names and signatures of the API functions are similar</li>
</ul>
<p>&hellip;and so on.</p>
<p>But if you consider the life of a GUI app versus a game - in general - user interfaces don&rsquo;t do anything except as a reaction to user input. Yes, there are exceptions, you can do animations, people do use Elm to make games, etc. But as a broad brush principle, most of the time your word processor or photo editing app are doing nothing, unless you are doing something with them. Hammering keys and painting with you mouse.</p>
<p>Games on the other hand are normally doing things <em>all the time</em>. Even if the player isn&rsquo;t doing anything! There <em>will</em> be background animations, particle effects will be firing, non-player characters will be walking around, your character will get bored and start impatiently tapping their foot.</p>
<p>Two of the main ways this difference visibly manifests itself are:</p>
<ol>
<li><code>Cmd</code> vs <code>Outcome</code></li>
<li>The nature of your <code>Model</code> instance</li>
</ol>
<h4 id="cmd-vs-outcome"><code>Cmd</code> vs <code>Outcome</code></h4>
<p>The update function in Tyrian returns a <code>(Model, Cmd)</code> where the command is a lazily evaluated task - perhaps an HTTP call or some other side effect. Whereas in Indigo you return an <code>Outcome</code>, but an outcome does not allow you to directly describe actions that would need evaluation, it only captures updated values and events. If you want to make an HTTP call, there&rsquo;s an event for that.</p>
<p>In Tyrian we expect that you&rsquo;ll be doing a lot of out-of-band work like calling web services and interacting with JS over and FFI, in Indigo we assume you mostly won&rsquo;t be.</p>
<p>This has the interesting side effect that Tyrian&rsquo;s update functions are referentially transparent, but Indigo&rsquo;s are both referentially transparent and declarative. The former allows you to do more practical things, the latter is lighter and easier to test, but less clean if you do need to, say, call down to JavaScript.</p>
<h4 id="the-nature-of-your-model">The nature of your <code>Model</code></h4>
<p>What is in your model?</p>
<p>In a GUI app, your model is probably quite close to representing the things that will be displayed. Perhaps it holds the current state of a quiz or survey for example, or the items in a todo list.</p>
<p>In a game, the model (in Indigo at least) tends to be much more abstract and divorced from any presentation concerns. So much so that Indigo has an extra model called a <code>ViewModel</code> that behaves more like a model in Tyrian.</p>
<p>As an example: Consider the score counter on a pinball machine. What makes these fun is that they do not simply show your score, they rapidly roll through the numbers always trying to <em>keep up</em> with your score!</p>
<p>We have two things we have to know to draw this effect:</p>
<ol>
<li>The real score the player has achieved.</li>
<li>The score currently being shown.</li>
</ol>
<p>In Tyrian, both of these values would be held in the <code>Model</code>.
In Indigo, the real score (1) would be held in the <code>Model</code> as it&rsquo;s a factual piece of data, while the currently displayed score would live in the <code>ViewModel</code> since it&rsquo;s purely there for presentation purposes.</p>





<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/tyrian/js/clipboard.min.js?1642039146"></script>
    <script src="/tyrian/js/perfect-scrollbar.min.js?1642039146"></script>
    <script src="/tyrian/js/perfect-scrollbar.jquery.min.js?1642039146"></script>
    <script src="/tyrian/js/jquery.sticky.js?1642039146"></script>
    <script src="/tyrian/js/featherlight.min.js?1642039146"></script>
    <script src="/tyrian/js/highlight.pack.js?1642039146"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/tyrian/js/modernizr.custom-3.6.0.js?1642039146"></script>
    <script src="/tyrian/js/learn.js?1642039146"></script>
    <script src="/tyrian/js/hugo-learn.js?1642039146"></script>
    
    

  </body>
</html>
